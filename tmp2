      finishedAt: latest.finishedAt
    });
  } catch (e) {
    console.error('summary endpoint error:', e);
    return res.status(500).json({ error: 'failed to build summary' });
  }
});
const workoutSessionExerciseSchema = new mongoose.Schema({
  exercise: { type: String },            // เก็บเป็น String ก็พอ (จะเป็น ObjectId string)
  name: String,
  type: { type: String, enum: ['reps','time'] },
  value: mongoose.Schema.Types.Mixed,    // seconds / reps / string
  order: Number
}, { _id: false });

const workoutSessionLogSchema = new mongoose.Schema({
  order: Number,
  exerciseId: String,
  name: String,
  target: {
    type: { type: String },              // 'time' | 'reps'
    value: String
  },
  performed: {
    seconds: { type: Number, default: 0 },
    reps: { type: Number, default: 0 }
  },
  calories: { type: Number, default: 0 },
  at: { type: Date, default: Date.now }
}, { _id: false });

app.listen(PORT, () => console.log(`Server running on port ${PORT}`));

